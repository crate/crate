apply plugin: 'java'
apply plugin: 'distribution'

archivesBaseName = 'crate-client'

evaluationDependsOn(':sql')

dependencies {
    compile project(':es')
    compile files(project(':sql').sourceSets.shared.output.classesDir)
    testCompile project(':testing')
    testCompile project(':sql')
}

configurations {
    all*.exclude group: 'org.elasticsearch'
    all*.exclude group: 'org.apache.lucene'
}



jar {
    dependsOn ':sql:compileSharedJava'
    baseName 'crate-client'
    duplicatesStrategy 'exclude'
    from configurations.compile.collect { it.isDirectory() ? it : zipTree(it).matching{
        exclude 'META-INF/**'
    }}

    manifest {
        attributes("Implementation-Title": "Crate Data Java Client")
    }
}

processResources {
    dependsOn ':sql:compileSharedJava'
}

compileJava {
    dependsOn ':sql:compileSharedJava'
}
