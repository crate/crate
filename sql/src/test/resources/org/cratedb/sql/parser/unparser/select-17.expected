SELECT (ROW_NUMBER() OVER w), (SUM(q) OVER (PARTITION BY c, d)) GROUP BY z WINDOW w AS (ORDER BY r)